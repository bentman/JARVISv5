# JARVISv5 Merged Development Roadmap (Weighted v2)

> Reassessed against advisor feedback and validated against `Project.md`.
> Uses dependency-first sequencing, with repo reset treated as hygiene (not a capability milestone).

---

## Source Anchors

- **End-goal architecture:** `Project.md`
- **Current verified state:** `SYSTEM_INVENTORY.md`
- **Working rules:** `AGENTS.md`

---

## Phase 0 — Verified Foundation (No Rebuild)

These are already verified and remain baseline assumptions:

- FSM lifecycle control (`INIT → PLAN → EXECUTE → VALIDATE → COMMIT → ARCHIVE`)
- Workflow node layer (`router`, `context_builder`, `llm_worker`, `validator`)
- Three-layer memory (working state, episodic, semantic store)
- Multi-turn continuation via `task_id`
- Dockerized local inference (`llama.cpp`)
- Validation harness and UI basic chat/status behavior

**Project.md citations:** §3.1, §4, §5.1, §9.1, §10.1

---

~~## Pre-Phase Gate — Repository Hygiene (Not a Milestone)~~ completed

### Why this comes first
This is operational safety, not capability delivery. It reduces risk before development but does not satisfy a Project.md feature target on its own.

### Scope
- Build/runtime artifact audit
- `.gitignore` hardening
- Remove non-source tracked artifacts
- Preserve/backup validation-significant traces before cleanup

### Required tool capabilities
- **System controls** (file cleanup, ignore rules)
- **Read-file** (audit what is currently tracked)
- **Write-output** (hygiene report)

**Project.md citation context:** supports traceability/operational reliability principles, though not a direct feature section (closest: §10, §12)

---

~~## Milestone 1 — Production Local Model Management~~ partial, remaining deferred

### Why this is first capability milestone
Explicitly prioritized moving from test/mini model behavior to a stable daily driver. This is foundational for all downstream milestones that depend on predictable local inference.

### Deliverables
~~- Production model catalog (size/profile-aware)~~ complete enough for usage, will enhance in future
~~- Checksum verification on download/load~~ deferred
~~- Hardware-profiled routing defaults~~ complete enough for usage, will enhance in future
~~- Resumable/reliable model fetch~~ deferred
~~- Daily-driver model default with explicit opt-in for test models~~ complete enough for usage, will enhance in future

### Required tool capabilities
- **System controls** (model lifecycle, hardware profiling)
- **Read-file** (catalog/config/state)
- **Write-output** (model audit logs, integrity status)

**Project.md citations:** §6.1, §6.2, §6.3, §9.2

---

~~## Milestone 2 — DAG Control-Plane Completion~~ completed

### Why this must precede tools/search expansion
`Project.md` requires deterministic control via FSM/DAG, not LLM-driven flow. The current FSM is verified for lifecycle; DAG is needed for intra-task dependency execution.

### Deliverables
- DAG executor with cycle detection and dependency ordering
- Plan-to-workflow compiler
- FSM + DAG integration (lifecycle + intra-task orchestration)

### Required tool capabilities
- **System controls** (execution graph/state transitions)
- **Read-file** (workflow definitions)
- **Write-output** (execution graph artifacts and traces)

**Project.md citations:** §3.1, §5.1, §5.2

---

~~## Milestone 3 — Baseline Determinism Harness~~ completed

### Why this is placed immediately after DAG
Instrumentation must arrive early enough to measure correctness of upcoming features. This avoids late-stage “build blind, validate late” risk.

### Deliverables
- Replay baseline harness
- Controller latency baseline
- Deterministic artifact comparison for repeated runs

### Required tool capabilities
- **Read-file** (episodic artifacts)
- **Write-output** (replay/latency reports)
- **System controls** (repeatable run control)

**Project.md citations:** §1 (Traceability), §10.1, §10.2

---

## Milestone 4 — Tool System + Sandboxed Execution

### Why this follows DAG + baseline harness
Tools introduce side effects; deterministic orchestration and replay instrumentation must be in place first to keep behavior auditable and fail-closed.

### Deliverables
- JSON-schema tool registry
- Permission tiers and constrained execution boundaries
- Tool-call workflow node with explicit IO contracts
- Core local tools (`read_file`, `write_file`, `list_directory`)

### Required tool capabilities
- **Read-file** (local data access)
- **Write-output** (structured tool outputs)
- **System controls** (sandbox/process controls)
- **Browsing** (optional future provider-facing adapters)

**Project.md citations:** §3.4, §5.1 (`tool_call`), §8.2

---

## Milestone 5 — Privacy & Security Controls

### Why this is before any external provider usage
Externalization must be policy-bound and privacy-protected. Redaction and security controls must exist before search/escalation is allowed.

### Deliverables
- PII redaction pipeline
- Security-relevant audit trail integration
- At-rest encryption for conversation/memory persistence (**needs deeper investigation**)

### Required tool capabilities
- **Read-file** (artifact scanning/classification)
- **Write-output** (redacted payloads + audit events)
- **System controls** (encryption/key handling policy)

**Project.md citations:** §8.1, §8.2, §6.3

---

## Milestone 6 — Implement Redis cache for retrieval/context results (with traceability)

### Why this is placed before retrieval/search scale-up
`Project.md` explicitly includes Redis in the operational stack for frequent-query/context caching. Implementing cache behavior before heavier retrieval/search paths improves responsiveness and reduces repeated backend work.

### Deliverables
- Redis-backed cache layer for frequent queries/context snippets
- Cache policy definition (TTL, invalidation, fail-safe fallback)
- Cache observability (hit/miss metrics in validation/reporting artifacts)

### Required tool capabilities
- **System controls** (service wiring, cache policy controls)
- **Read-file** (cache configuration + backend settings)
- **Write-output** (cache metrics and trace artifacts)

**Project.md citations:** §9.1, §10.2

---

## Milestone 7 — Hybrid Semantic Retrieval

### Why this is before external search/escalation
Strengthening local recall first supports local-first operation and reduces unnecessary escalation. It directly advances semantic memory quality.

### Deliverables
- Episodic + semantic hybrid retriever
- Context builder upgrade to weighted retrieval
- Memory quality checks for long-range recall

### Required tool capabilities
- **Read-file** (episodic + semantic metadata)
- **Write-output** (retrieval evidence + ranking metadata)
- **System controls** (index/retrieval weighting config)

**Project.md citations:** §4.3, §5.1 (`context_builder`), §1 (Local-First Execution)

---

## Milestone 8 — Search + Policy-Bound Escalation

### Why this is now safe
By this point, local inference, deterministic orchestration, privacy controls, and stronger retrieval are established. External calls can now be governed, redacted, and audited.

### Deliverables
- Search provider integration (`search_web`)
- Escalation policy routing with budget governance
- Full external-call audit record (redacted request, decision reason, cost)

### Required tool capabilities
- **Browsing** (search provider access)
- **Read-file** (policy + budget state)
- **Write-output** (search results and escalation audit)
- **System controls** (provider gating and quotas)

**Project.md citations:** §3.4, §5.1 (`search_web`), §6.3, §9.2

---

## Milestone 9 — UI Completion (Spec-Aligned)

### Why this is late-mid sequence
UI should expose real capabilities once backend contracts stabilize. Workflow visualization depends on DAG telemetry already being in place.

### Deliverables
- Workflow visualizer (live node/status flow)
- Settings panel (hardware/privacy/budget controls)
- Chat UX updates aligned to new capabilities

### Required tool capabilities
- **Read-file** (settings/state retrieval)
- **Write-output** (user configuration/state persistence)
- **Browsing** (frontend interaction surface)

**Project.md citations:** §11.2, §9.2, §6.3

---

## Milestone 10 — Final Metrics & Invariant Closure

### Why this is final closure, not initial instrumentation
Baseline checks were introduced in Milestone 3. This milestone is full-goal certification against Project.md targets after all core capabilities are integrated.

### Deliverables
- Reproducibility validation
- Memory recall validation
- Task-success and drift validation
- Latency target confirmation and final capability ledger update

### Required tool capabilities
- **Read-file** (all validation artifacts)
- **Write-output** (final reports + inventory updates)
- **System controls** (deterministic replay runs)

**Project.md citations:** §10.1, §10.2

---

## Milestone 11 — Voice System (Optional)

### Why this remains optional and last
Voice is explicitly optional for core usage. It should not delay closure of deterministic, local-first assistant invariants.

### Deliverables
- STT integration
- TTS integration
- Wake-word path and episodic parity with text workflows

### Required tool capabilities
- **System controls** (audio pipeline runtime)
- **Read-file** (voice/session state)
- **Write-output** (voice session traces)

**Project.md citations:** §2 (Voice Optional), §7.1, §7.2

---

## Condensed Dependency Chain

```
Hygiene Gate (non-milestone)
  → M1 Model Management
  → M2 DAG Control Plane
  → M3 Baseline Determinism Harness
  → M4 Tools + Sandbox
  → M5 Privacy/Security
  → M6 Redis Caching Integration
  → M7 Hybrid Semantic Retrieval
  → M8 Search + Escalation
  → M9 UI Completion
  → M10 Final Metrics Closure
  → M11 Voice (Optional)
```

---

## Out-of-Scope Until Core Closure

- Multi-user architecture
- Non-essential UI polish beyond spec-listed elements
- Expansion features that bypass local-first/policy-bound requirements
